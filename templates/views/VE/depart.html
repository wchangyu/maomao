<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>重庆大学虚拟实验室</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta content="" name="description" />
    <meta content="" name="author" />
    <link href="../../../assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/plugins/select2/select2.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/admin/pages/css/login-soft.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/css/components.css" id="style_components" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/css/plugins.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/admin/layout/css/layout.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="../favicon.ico" />
</head>
<body class="page-quick-sidebar-over-content">
    <div class="page-container">
        <div class="page-content-wrapper">
            <div class="portlet light bg-inverse">
                <div class="portlet-body full-height-content">
                    <h3 style="text-align:center;">院系管理</h3>
                    <hr />
                    <div class="row">
                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"></div>
                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                            <div>
                                <input class="form-control placeholder-no-fix" style="width:200px;float:left;margin-right:10px;"
                                       type="text" placeholder="输入院系名称" id="departName" name="departName" />
                                <a id="save-depart-btn" class="btn btn-default green">
                                    保存
                                </a>
                            </div>
                        </div>
                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"></div>
                    </div>
                    <div class="row margin-top-20">
                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"></div>
                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                            <table id="oTable" class="table table-striped table-bordered table-advance table-hover">
                                <thead>
                                    <tr>
                                        <th>院系序号</th>
                                        <th>院系名称</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="../../../assets/global/plugins/jquery.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/jquery-migrate.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/jquery.cokie.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/jquery-validation/js/jquery.validate.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/backstretch/jquery.backstretch.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/select2/select2.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/scripts/metronic.js" type="text/javascript"></script>
    <script src="../../../assets/admin/layout/scripts/layout.js" type="text/javascript"></script>
    <script src="../../../assets/admin/layout/scripts/demo.js" type="text/javascript"></script>
    <script>
        jQuery(document).ready(function () {
            Metronic.init();
            Layout.init();
        });
    </script>
    <script type="text/javascript">
        var oTable = null;
        function departs() {
            var departUrl = "/Depart/GetDepartDs?r=" + Math.random();
            $.get(departUrl, function (res) {
                var dataArr = [];
                for (var i = 0; i < res.length; i++) {
                    var arr = [];
                    arr.push(res[i].ID);
                    arr.push(res[i].Name);
                    dataArr.push(arr);
                }
                if (oTable === null) {
                    oTable = $("#oTable").dataTable({
                        "iDisplayLength": 25,
                        "bFilter": false,
                        "bLengthChange": false,
                        "autoWidth": true,  //用来启用或禁用自动列的宽度计算
                        "paging": false,   //是否分页
                        "destroy": true,//还原初始化了的datatable
                        "searching": false,
                        "paging": true,
                        "searching": false,
                        "ordering": false,
                        "bFilter": false,
                        "bPaginate": true, //翻页功能
                        "bSort": false,
                        "bProcessing": false,
                        "destroy": true,
                        "sPaginationType": "bootstrap", //分页样式
                        "oLanguage": {
                            "sLengthMenu": "每页显示 _MENU_ 条记录",
                            "sZeroRecords": "没有任何院系数据",
                            "sEmptyTable": "没有任何院系数据",
                            "sInfo": "当前显示 _START_ 到 _END_ 条，共 _TOTAL_ 条记录",
                            "sInfoFiltered": "数据表中共为 _MAX_ 条记录",
                            "sInfoEmpty": "",
                            "sSearch": "搜索",
                            "oPaginate": {
                                "sFirst": "首页",
                                "sPrevious": "上一页",
                                "sNext": "下一页",
                                "sLast": "末页"
                            },
                        },
                        "aoColumns": [{
                            "fnRender": function (oObj) {
                                return oObj.aData[0];
                            }
                        }, {
                            "fnRender": function (oObj) {
                                return oObj.aData[1];
                            }
                        }]
                    });
                }
                //清空一下table
                oTable.fnClearTable();
                //想表格中添加东西数据
                if (dataArr.length > 0) {
                    oTable.fnAddData(dataArr);
                }
                //重绘表格
                oTable.fnDraw();
                $('.dataTables_info').hide();
                $('.dataTables_paginate').hide();
            });
        }
        $(document).ready(function () {
            $('#save-depart-btn').on('click', function () {
                var departName = $('#departName').val();
                if (departName.length === 0) {
                    alert('院系名称为必填字段.');
                } else {
                    var pushUrl = "/Depart/PushDepart";
                    $.post(pushUrl, {
                        Name: departName
                    }, function (rescode) {
                        if (rescode === 99) {
                            departs();
                        } else {
                            alert('保存院系信息失败.');
                        }
                    });
                }
            });
        });
    </script>
</body>
</html>