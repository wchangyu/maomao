<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>重庆大学虚拟实验室</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <meta content="" name="description" />
    <meta content="" name="author" />
    <link href="../../../assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/plugins/uniform/css/uniform.default.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/plugins/select2/select2.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/admin/pages/css/login-soft.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/css/components.css" id="style_components" rel="stylesheet" type="text/css" />
    <link href="../../../assets/global/css/plugins.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/admin/layout/css/layout.css" rel="stylesheet" type="text/css" />
    <link href="../../../assets/admin/layout/css/themes/darkblue.css" rel="stylesheet" type="text/css" id="style_color" />
    <link href="../../../assets/admin/layout/css/custom.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="../favicon.ico" />
</head>
<body class="login">
    <div class="logo">
        <a href="index.html">
            <img src="../../../assets/admin/layout/img/logo-big.png" alt="" />
        </a>
    </div>
    <div class="menu-toggler sidebar-toggler">
    </div>
    <div class="content">
        <form class="register-form" method="post">
            <h3 style="text-align:center;">注册您的账户</h3>
            <div class="alert alert-danger display-hide">
                <button class="close" data-close="alert"></button>
                <span>
                    请输入用户信息
                </span>
            </div>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9">学号</label>
                <div class="input-icon">
                    <i class="fa fa-bold"></i>
                    <input class="form-control placeholder-no-fix" type="text"
                           placeholder="学生学号、老师工号(必填)"
                           name="number" />
                </div>
            </div>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9">姓名</label>
                <div class="input-icon">
                    <i class="fa fa-user"></i>
                    <input class="form-control placeholder-no-fix" type="text"
                           placeholder="姓名(必填)"
                           name="name" />
                </div>
            </div>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9">密码</label>
                <div class="input-icon">
                    <i class="fa fa-lock"></i>
                    <input class="form-control placeholder-no-fix" type="password"
                           autocomplete="off" placeholder="密码(必填)"
                           name="password" />
                </div>
            </div>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9">联系方式</label>
                <div class="input-icon">
                    <i class="fa fa-phone"></i>
                    <input class="form-control placeholder-no-fix" type="text"
                           autocomplete="off" placeholder="联系方式"
                           name="phone" />
                </div>
            </div>
            <p>
                请选择院系
            </p>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9">院系</label>
                <select name="depart" id="depart" class="select2 form-control">
                    <option value="1">空调系</option>
                    <option value="2">计算机系</option>
                </select>
            </div>
            <p>
                请选择所在班级
            </p>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9">班级</label>
                <select name="class" id="class" class="select2 form-control">
                    <option value="1">1班</option>
                    <option value="2">2班</option>
                </select>
            </div>
            <p>
                请选择身份
            </p>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9">角色</label>
                <select name="role" id="role" class="select2 form-control">
                    <option value="1" selected>教师</option>
                    <option value="2">学生</option>
                </select>
            </div>
            <div class="form-actions">
                <a id="register-back-btn" class="btn btn-default" href="signin.html">
                    <i class="m-icon-swapleft"></i> 返回登录
                </a>
                <button type="submit" id="registerBtn" class="btn blue pull-right">
                    注册 <i class="m-icon-swapright m-icon-white"></i>
                </button>
            </div>
        </form>
    </div>
    <div class="copyright">
        2017 &copy; 北京华勤创新软件有限公司
    </div>
    <script src="../../../assets/global/plugins/jquery.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/jquery-migrate.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/jquery.cokie.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/jquery-validation/js/jquery.validate.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/backstretch/jquery.backstretch.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/plugins/select2/select2.min.js" type="text/javascript"></script>
    <script src="../../../assets/global/scripts/metronic.js" type="text/javascript"></script>
    <script src="../../../assets/admin/layout/scripts/layout.js" type="text/javascript"></script>
    <script src="../../../assets/admin/layout/scripts/demo.js" type="text/javascript"></script>
    <script>
        jQuery(document).ready(function () {
            Metronic.init();
            Layout.init();
        });
    </script>
    <script>
        jQuery(document).ready(function () {
            $.backstretch([
             "assets/media/bg/1.jpg",
             "assets/media/bg/2.jpg",
             "assets/media/bg/3.jpg",
             "assets/media/bg/4.jpg"
            ], {
                fade: 1000,
                duration: 8000
            }
         );
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.register-form').validate({
                errorElement: 'span',
                errorClass: 'help-block',
                focusInvalid: false,
                rules: {
                    number: {
                        required: true
                    },
                    name: {
                        required: true
                    },
                    password: {
                        required: true
                    }
                },
                messages: {
                    number: {
                        required: "工号是必填字段."
                    },
                    name: {
                        required: "姓名是必填字段."
                    },
                    password: {
                        required: "密码是必填字段."
                    }
                },
                invalidHandler: function (event, validator) {
                    $('.alert-danger', $('.register-form')).show();
                },
                highlight: function (element) {
                    $(element)
	                    .closest('.form-group').addClass('has-error');
                },
                success: function (label) {
                    label.closest('.form-group').removeClass('has-error');
                    label.remove();
                },
                errorPlacement: function (error, element) {
                    error.insertAfter(element.closest('.input-icon'));
                },
                submitHandler: function (form) {
                    $('#registerBtn').attr('disabled', 'disabled');
                    $('#registerBtn').html('正在注册...');
                    var signupUrl = "User/SignupUser";
                    $.post(signupUrl, {
                        Number: $('#number').val(),
                        Name: $('#name').val(),
                        Password: $('#password').val(),
                        ClassID: $('#class').val(),
                        RoleID: $('#role').val(),
                        Phone: $('#phone').val()
                    }, function (res) {
                        if (res === 3) {
                            alert('抱歉。用户注册失败！请与管理员联系。');
                            $('#registerBtn').removeAttr('disabled');
                            $('#registerBtn').html('登录');
                        } else {
                            alert('恭喜。用户注册成功！请登录。');
                            window.location.href = "signin.html";
                        }
                    });
                }
            });
            $('.register-form input').keypress(function (e) {
                if (e.which == 13) {
                    if ($('.register-form').validate().form()) {
                        $('.register-form').submit();
                    }
                    return false;
                }
            });
        });
    </script>
</body>
</html>